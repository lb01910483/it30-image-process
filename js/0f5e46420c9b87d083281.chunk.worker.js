!function(t){var r={};function n(e){if(r[e])return r[e].exports;var o=r[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=r,n.d=function(t,r,e){n.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:e})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,r){if(1&r&&(t=n(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)n.d(e,o,function(r){return t[r]}.bind(null,o));return e},n.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(r,"a",r),r},n.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},n.p="/it30-image-process/",n(n.s=5)}([function(t,r,n){t.exports=n(4)},function(t,r){function n(t,r,n,e,o,a,i){try{var u=t[a](i),c=u.value}catch(t){return void n(t)}u.done?r(c):Promise.resolve(c).then(e,o)}t.exports=function(t){return function(){var r=this,e=arguments;return new Promise((function(o,a){var i=t.apply(r,e);function u(t){n(i,o,a,u,c,"next",t)}function c(t){n(i,o,a,u,c,"throw",t)}u(void 0)}))}}},function(t,r){t.exports=function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}},function(t,r){function n(t,r){for(var n=0;n<r.length;n++){var e=r[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}t.exports=function(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),t}},function(t,r,n){var e=function(t){"use strict";var r,n=Object.prototype,e=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,n,e){var o=r&&r.prototype instanceof p?r:p,a=Object.create(o.prototype),i=new j(e||[]);return a._invoke=function(t,r,n){var e=h;return function(o,a){if(e===l)throw new Error("Generator is already running");if(e===d){if("throw"===o)throw a;return S()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var u=M(i,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(e===h)throw e=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);e=l;var c=f(t,r,n);if("normal"===c.type){if(e=n.done?d:s,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(e=d,n.method="throw",n.arg=c.arg)}}}(t,n,i),a}function f(t,r,n){try{return{type:"normal",arg:t.call(r,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h="suspendedStart",s="suspendedYield",l="executing",d="completed",v={};function p(){}function g(){}function y(){}var m={};m[a]=function(){return this};var w=Object.getPrototypeOf,x=w&&w(w(P([])));x&&x!==n&&e.call(x,a)&&(m=x);var b=y.prototype=p.prototype=Object.create(m);function L(t){["next","throw","return"].forEach((function(r){t[r]=function(t){return this._invoke(r,t)}}))}function E(t){var r;this._invoke=function(n,o){function a(){return new Promise((function(r,a){!function r(n,o,a,i){var u=f(t[n],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&e.call(h,"__await")?Promise.resolve(h.__await).then((function(t){r("next",t,a,i)}),(function(t){r("throw",t,a,i)})):Promise.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,i)}))}i(u.arg)}(n,o,r,a)}))}return r=r?r.then(a,a):a()}}function M(t,n){var e=t.iterator[n.method];if(e===r){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=r,M(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=f(e,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=r),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function _(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function O(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(e.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=r,n.done=!0,n};return i.next=i}}return{next:S}}function S(){return{value:r,done:!0}}return g.prototype=b.constructor=y,y.constructor=g,y[u]=g.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===g||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},L(E.prototype),E.prototype[i]=function(){return this},t.AsyncIterator=E,t.async=function(r,n,e,o){var a=new E(c(r,n,e,o));return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(b),b[u]="Generator",b[a]=function(){return this},b.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var n in t)r.push(n);return r.reverse(),function n(){for(;r.length;){var e=r.pop();if(e in t)return n.value=e,n.done=!1,n}return n.done=!0,n}},t.values=P,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&e.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(e,o){return u.type="throw",u.arg=t,n.next=e,o&&(n.method="next",n.arg=r),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],u=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=e.call(i,"catchLoc"),f=e.call(i,"finallyLoc");if(c&&f){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&e.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=r,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),v},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),v}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===t){var e=n.completion;if("throw"===e.type){var o=e.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,e){return this.delegate={iterator:P(t),resultName:n,nextLoc:e},"next"===this.method&&(this.arg=r),v}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}},function(t,r,n){"use strict";n.r(r);var e={};n.r(e),n.d(e,"grayscale",(function(){return l})),n.d(e,"invert",(function(){return d})),n.d(e,"brightness",(function(){return v})),n.d(e,"calculateBrightness",(function(){return p})),n.d(e,"contrast",(function(){return g})),n.d(e,"rgbToHsv",(function(){return y})),n.d(e,"hsvToRgb",(function(){return m})),n.d(e,"rgbToHsl",(function(){return w})),n.d(e,"hslToRgb",(function(){return x})),n.d(e,"clamp",(function(){return b})),n.d(e,"convertRange",(function(){return L})),n.d(e,"saturation",(function(){return E})),n.d(e,"vibrance",(function(){return M})),n.d(e,"shadow",(function(){return _})),n.d(e,"hightLight",(function(){return O})),n.d(e,"convolve",(function(){return j})),n.d(e,"sharpen",(function(){return P}));n(0),n(1);var o,a,i,u,c,f,h,s,l=function(t){for(var r=0;r<t.length;r+=4){var n=(t[r]+t[r+1]+t[r+2])/3;t[r]=n,t[r+1]=n,t[r+2]=n}return t},d=function(t){for(var r=0;r<t.length;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2];return t},v=function(t,r){for(var n=t.data,e=0;e<n.length;e+=4)n[e]=n[e]+r,n[e+1]=n[e+1]+r,n[e+2]=n[e+2]+r;return t},p=function(t){for(var r={},n=0;n<t.length;n+=4){var e=t[n],o=t[n+1],a=t[n+2],i=Math.round(.299*e+.587*o+.114*a);r[i]=r[i]||0,r[i]+=1}var u=[];return Object.keys(r).forEach((function(t){u.push([t,r[t]])})),u},g=function(t,r){for(var n=t.data,e=350*(r+255)/(255*(350-r)),o=0;o<n.length;o+=4)n[o]=e*(n[o]-128)+128,n[o+1]=e*(n[o+1]-128)+128,n[o+2]=e*(n[o+2]-128)+128;return t},y=function(t){var r,n,e,o,a,i=t[0]/255,u=t[1]/255,c=t[2]/255,f=Math.max(i,u,c),h=f-Math.min(i,u,c),s=function(t){return(f-t)/6/h+.5};return 0===h?(o=0,a=0):(a=h/f,r=s(i),n=s(u),e=s(c),i===f?o=e-n:u===f?o=1/3+r-e:c===f&&(o=2/3+n-r),o<0?o+=1:o>1&&(o-=1)),[360*o,100*a,100*f]},m=function(t){var r=t[0]/60,n=t[1]/100,e=t[2]/100,o=Math.floor(r)%6,a=r-Math.floor(r),i=255*e*(1-n),u=255*e*(1-n*a),c=255*e*(1-n*(1-a));switch(e*=255,o){case 0:return[e,c,i];case 1:return[u,e,i];case 2:return[i,e,c];case 3:return[i,u,e];case 4:return[c,i,e];case 5:return[e,i,u]}},w=function(t){var r,n=t[0]/255,e=t[1]/255,o=t[2]/255,a=Math.min(n,e,o),i=Math.max(n,e,o),u=i-a;i===a?r=0:n===i?r=(e-o)/u:e===i?r=2+(o-n)/u:o===i&&(r=4+(n-e)/u),(r=Math.min(60*r,360))<0&&(r+=360);var c=(a+i)/2;return[r,100*(i===a?0:c<=.5?u/(i+a):u/(2-i-a)),100*c]},x=function(t){var r,n,e,o=t[0]/360,a=t[1]/100,i=t[2]/100;if(0===a)return[e=255*i,e,e];for(var u=2*i-(r=i<.5?i*(1+a):i+a-i*a),c=[0,0,0],f=0;f<3;f++)(n=o+1/3*-(f-1))<0&&n++,n>1&&n--,e=6*n<1?u+6*(r-u)*n:2*n<1?r:3*n<2?u+(r-u)*(2/3-n)*6:u,c[f]=255*e;return c},b=function(t,r,n){return Math.min(Math.max(t,r),n)},L=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-100,100];return(t-n[0])*(r[1]-r[0])/(n[1]-n[0])+r[0]},E=function(t,r){for(var n=t.data,e=0;e<n.length;e+=4){var o=[n[e],n[e+1],n[e+2]],a=w([o[0],o[1],o[2]]);a[1]=b(a[1]+L(r,[-100,100]),0,100);var i=x(a);n[e]=i[0],n[e+1]=i[1],n[e+2]=i[2]}return t},M=function(t,r){for(var n=t.data,e=0;e<n.length;e+=4){var o=[n[e],n[e+1],n[e+2]],a=w([o[0],o[1],o[2]]);a[1]<40&&(a[1]=b(a[1]+L(r,[-40,40]),0,40));var i=x(a);n[e]=i[0],n[e+1]=i[1],n[e+2]=i[2]}return t},_=function(t,r){for(var n=t.data,e=0;e<n.length;e+=4){var o=[n[e],n[e+1],n[e+2]],a=w([o[0],o[1],o[2]]);a[2]<40&&(a[2]=b(a[2]+L(r,[-10,10]),0,100));var i=x(a);n[e]=i[0],n[e+1]=i[1],n[e+2]=i[2]}return t},O=function(t,r){for(var n=t.data,e=0;e<n.length;e+=4){var o=[n[e],n[e+1],n[e+2]],a=w([o[0],o[1],o[2]]);a[2]>70&&(a[2]=b(a[2]+L(r,[-10,10]),0,100));var i=x(a);n[e]=i[0],n[e+1]=i[1],n[e+2]=i[2]}return t},j=function(t,r,n){for(var e=t.data,o=t.width,a=t.height,i=new ImageData(new Uint8ClampedArray(t.data),t.width,t.height),u=Math.sqrt(r.length),c=Math.floor(u/2),f=i.data,h=0;h<a;h++)for(var s=0;s<o;s++){for(var l=4*(h*o+s),d=0,v=0,p=0,g=0;g<u;g++)for(var y=0;y<u;y++){var m=h+g-c,w=s+y-c;if(!(m<0||m>=a||w<0||w>=o)){var x=4*(m*o+w),b=r[g*u+y],L=[e[x],e[x+1],e[x+2]];d+=L[0]*b,v+=L[1]*b,p+=L[2]*b}}n?(f[l]=d*n+f[l]*(1-n),f[l+1]=v*n+f[l+1]*(1-n),f[l+2]=p*n+f[l+2]*(1-n)):(f[l]=d,f[l+1]=v,f[l+2]=p)}return i},P=function(t,r){if(r>0){return j(t,[0,-1,0,-1,5,-1,0,-1,0],L(r,[0,1],[0,100]))}return j(t,[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],L(Math.abs(r),[0,1],[0,100]))},S=["brightness","contrast","saturation","vibrance","shadow","hightLight","sharpen"],T=n(2),k=n.n(T),G=n(3),N=n.n(G),F=function(){function t(r){var n=r.ctx,e=r.width,o=r.height;k()(this,t),this.ctx=n,this.width=e,this.height=o,this.data=[]}return N()(t,[{key:"addBarrage",value:function(t){var r={x:this.width,y:this.height*Math.random(),speed:t.speed||10*Math.random()+.5,fontSize:t.fontSize||10*Math.random()+16,color:t.color||"#".concat(((1<<24)*Math.random()|0).toString(16)),text:t.text||"default"};this.data.push(r)}},{key:"draw",value:function(){for(var t=this.data.length-1;t>=0;t-=1){var r=this.data[t];this.ctx.font="".concat(r.fontSize,"px Microsoft JhengHei, PMingLiU, sans-serif");var n=this.ctx.measureText(r.text).width;r.x+n<0?this.data.splice(t,1):(this.ctx.fillStyle=r.color,r.x=r.x-r.speed,this.ctx.fillText(r.text,r.x,r.y))}}}]),t}(),I=function t(){performance.now();performance.now(),a.drawImage(i,0,0,u,c);var r,n,o=a.getImageData(0,0,u,c),h=(r=o,n=f,S.reduce((function(t,r){var o=n[r];return 0!==o?e[r](t,o):t}),r));a.putImageData(h,0,0),s.draw(),requestAnimationFrame(t)};onmessage=function(t){if("init"===t.data.type)o=t.data.offscreen,a=o.getContext("2d"),u=t.data.width,c=t.data.height,s=new F({ctx:a,width:u,height:c});else if("process"===t.data.type&&a){var r=t.data,n=r.imageBitmap,e=r.sliderValue;i=n,f=e,h||(h=!0,I())}else"barrage"===t.data.type&&s&&(s.addBarrage(t.data.data),this.console.log("barrage",s))}}]);